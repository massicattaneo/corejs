/**
 * corejs - Javascript Framework
 * @version v1.1.0
 * @link https://github.com/massicattaneo/corejs#readme
 * @license ISC
 * @author Massimiliano Cattaneo
 */
function cjs(){}!function(t){function e(t){return t&&t.toString().indexOf("native code")===-1}t.create=function(t){return n(new cjs,t||{})},t.extend=function(t){return{create:function(e){return n(new t,e||{})},CollectionOf:function(e){return{create:function(r){var i=n(new t,o(e));return n(new i,r||{})}}}}};var n=function(t,e){var n=a(e.constructor,t.constructor);n.prototype=t;for(var r in e)n.prototype[r]=a(e[r],t[r]);return n};t.CollectionOf=function(t){return{create:function(e){return n(o(t),e||{})}}};var r=function(t,e,n){var r=[];t.each(function(n){r.push({a1:t[n],a2:e[n]})}),r.sort(function(t,e){return n?t.a1>e.a1?-1:t.a1===e.a1?0:1:t.a1<e.a1?-1:t.a1===e.a1?0:1}),r.each(function(n,r){t[n]=r.a1,e[n]=r.a2})},i=function(t,e,n){var r=t.splice(n,1,t[e]);t[e]=r[0]},o=function(t){var e={VERSUS:{ascending:0,descending:1},constructor:function(t){this.initValues(),"array"==typeof t&&t.each(function(t,e){e&&this.add(e)},this)},initValues:function(){this.items=[],this.keys=[],this.__counterId=0},size:function(){return this.items.length},isEmpty:function(){return 0===this.size()},add:function(t,e){var n="undefined"==typeof e?this.__counterId++:e;return this.keys.push(n),this.items.push(t),n},sortByItem:function(t){r(this.items,this.keys,t)},sortByKey:function(t){r(this.keys,this.items,t)},sortBy:function(t,e){var n=[],i=[];this.each(function(e,r,o){n.push(o[t]),i.push(o[t])}),r(n,this.keys,e),r(i,this.items,e)},newItem:function(e){var n=new t;return this.add(n,e),n},get:function(t){return this.items[this.keys.indexOf(t)]},getAt:function(t){return this.items[t]},getKeyAt:function(t){return this.keys[t]},set:function(t,e){var n=this.keys.indexOf(t);return this.items[n]=e,n},setAt:function(t,e){return this.items[t]=e,this.keys[t]},setKey:function(t,e){var n=this.keys.indexOf(t);return this.keys[n]=e,n},getLast:function(t){return this.items[this.keys.lastIndexOf(t)]},swap:function(t,e){i(this.items,t,e),i(this.keys,t,e)},getCollection:function(e,n){var r=new(cjs.CollectionOf(t).create());return this.each(function(t,i,o){o[e]===n&&r.add(o,i)}),r},indexOf:function(t){return this.items.indexOf(t)},addCollection:function(t){var e=this;t.each(function(t,n,r){e.add(r,n)})},remove:function(t){var e,n=0;do n=this.keys.indexOf(t),n!==-1&&(this.keys.splice(n,1),e=this.items.splice(n,1));while(n!==-1);return e[0]||null},removeAt:function(t){return this.keys.splice(t,1),this.items.splice(t,1)[0]},removeItem:function(t){var e=this.indexOf(t),n=this.keys[e];return this.remove(n)},filter:function(e){var n=new(cjs.CollectionOf(t).create());return this.each(function(t,r,i){"undefined"!=typeof e&&r!==e||n.add(i,e)}),n},clone:function(){return this.filter()},each:function(t,e){for(var n=0;n<this.items.length;n++)t.call(e||this,parseInt(n,10),this.keys[n],this.items[n])},clear:function(){this.items=[],this.keys=[]},toArray:function(){var t=[];return this.each(function(e,n,r){t.push(r)}),t},toJSON:function(){var t={};return this.each(function(e,n,r){t[n]=r}),t}};return e},a=function(t,n){return"function"==typeof t?function(){return this.parent=n,e(t)?t.apply(this,arguments):n.apply(this,arguments)}:t};t.Collection=function(t){return new(cjs.CollectionOf(Object).create())(t)}}(cjs),function(){cjs.Array={},cjs.Array.clone=function(t){return t.slice(0)},cjs.Array.createWithIndexes=function(t,e){var n=[];e=e||0;for(var r=0;r<=t-e;r++)n[r]=r+e;return n}}(),String.prototype.replaceAt=function(t,e,n){return this.substr(0,t)+n+this.substr(t+e)},String.prototype.insertAt=function(t,e){return this.substr(0,t)+e+this.substr(t)},String.prototype.removeAt=function(t,e){return e="undefined"==typeof e?1:e,this.substr(0,t)+this.substr(t+e)},String.prototype.padLeft=function(t,e){return 0===t?"":(Array(t+1).join(e)+this).slice(-t)},String.prototype.padRight=function(t,e){return 0===t?"":(this+Array(t+1).join(e)).slice(0,t)},String.prototype.removeHTMLTags=function(){return this.replace(/<\/?[^>]+(>|$)/g,"")},String.prototype.startsWith=function(t){return this.substr(0,t.length)===t},String.prototype.highlightWord=function(t,e,n){e=e||"strong";var r=new RegExp("("+t+")","gi");return strClass=n?' class="'+n+'"':"",this.replace(r,"<"+e+strClass+">$1</"+e+">")},String.prototype.isTime=function(){return/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/.test(this)},String.prototype.isDate=function(){var t=this.indexOf("-")!==-1?"-":"/",e=this.split(t);if(e.join("-").length<10)return!1;var n=new Date(e.join("-"));return!/Invalid|NaN/.test(n.toString())&&(n.getDate()===parseInt(e[2],10)&&n.getFullYear()===parseInt(e[0],10))},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1).toString().toLowerCase()},String.prototype.toDate=function(){if(!isNaN(this))return new Date(parseInt(this));var t=this.split(this.match(/\D/));return new Date(parseInt(t[0],10),parseInt(t[1],10)-1,parseInt(t[2],10))},function(t){t.toCamelCase=function(){var t=this;if(t.match(/\s|-|_/)){t=t.toLowerCase();var e=t.match(/([^\s|_|-]*)/g);return e.reduce(function(t,e){return t+e.capitalize()})}return t.match(/[a-z]/)?t:t.toLowerCase()};var e=function(t,n){if(t.match(/\s/)){var r=t.match(/([^\s]*)/g);return r.reduce(function(t,e){return t.toLowerCase()+(e?n+e.toLowerCase():"")})}return t.match(new RegExp(n))?t.toLowerCase():t.match(/_/)?t.toLowerCase().replace(/_/g,"-"):t.match(/-/)?t.toLowerCase().replace(/-/g,"_"):e(t.replace(/([A-Z])/g," $1").replace(/^./,function(t){return t.toUpperCase()}),n)};t.toKebabCase=function(){return e(this,"-")},t.toSnakeCase=function(){return e(this,"_")}}(String.prototype),function(){cjs.Object={},cjs.Object.extend=function(){for(var t=arguments[0],e=0,n=arguments.length;e<n;e++){var r=arguments[e];Object.keys(r).forEach(function(e){t[e]=r[e]})}return t},cjs.Object.clone=function(t){return cjs.Object.extend({},t)},cjs.Object.toXML=function(t){function e(t,e){var n=document.createElement(t);return n.innerText=e,n}function n(t,n,i){for(var o=0;o<t.length;o++)"object"!=typeof t[o]?i.appendChild(e(n,t[o])):i.appendChild(r(t[o],n))}function r(t,i){var o=document.createElement(i);for(var a in t)t.hasOwnProperty(a)&&(t[a]instanceof Array?n(t[a],a,o):"object"!=typeof t[a]?o.appendChild(e(a,t[a])):o.appendChild(r(t[a],a)));return o}return r(t,"Model")}}(cjs),function(){function t(){for(var t=0;t<arguments.length;t++){var e=arguments[t].trim();this.className?this.className.match(e)||(this.className+=" "+e):this.className=e}}function e(){this.className=""}function n(){for(var t=0;t<arguments.length;t++){var e=arguments[t].trim();this.className.match(e)&&(this.className=this.className.replace(e,"").replace(/\s\s/g," ").trim())}}function r(t){return null!==this.className.match(t)}function i(e){r.call(this,e)?n.call(this,e):t.call(this,e)}function o(t,e){this._listeners=this._listeners||[],this._listeners.push({action:t,callback:e}),this.addEventListener?this.addEventListener(t,e):this.attachEvent("on"+t,e)}function a(t,e){this.removeEventListener?this.removeEventListener(t,e):this.detachEvent("on"+t,e)}function c(){this._listeners&&this._listeners.forEach(function(t){a.call(this,t.action,t.callback)},this)}function s(){for(var t=this.firstChild;t;)this.removeChild(t),t=this.firstChild;return this}function u(t){var e=t||window.event;return e.target||e.srcElement}function f(t){return this.textContent=t,this.innerText=t,this}function h(t,e){if(document.action){var n=document.createEventObject();return n.data=e,this.fireEvent("on"+t,n)}var r=document.createEvent("HTMLEvents");return r.initEvent(t,!0,!0),r.data=e,!this.dispatchEvent(r)}function l(){return"checkbox"===this.getAttribute("type")?this.checked:this.innerText}function d(t){var e=document.createElement("div");return e.innerHTML=t,e.children[0]}function p(t){var e=t.textContent||t.innerText,n=isNaN(e)?e:parseFloat(e);return n}function g(t){for(var e={},n=0;n<t.length;n++){var r=t[n],i=r.tagName.toCamelCase();!e[i]||e[i]instanceof Array||(e[i]=[e[i]]);var o=g(r.children)||p(r);e[i]instanceof Array?e[i].push(o):e[i]=o}return y(e)?null:e}function m(){return g(this.children)}function v(u){var d={};return[t,e,n,r,i,o,a,c,f,l,h,m,s].forEach(function(t){d[t.name]=function(){var e=t.apply(u,arguments);return void 0===e?d:e}}),d.get=function(){return u},d.getAttribute=function(t){return u&&u.getAttribute?u.getAttribute(t):null},d.getTagName=function(){return u.tagName},d.attributes=function(){return u.attributes},d.setAttribute=function(t,e){return u.setAttribute(t,e)},d.children=function(){if(!u||!u.childNodes)return[];var t=Array.prototype.slice.call(u.childNodes);return t.map(function(t){return v(t)})},d}var y=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};cjs.Node=function(t){if("object"==typeof t)return v(u(t));if(t.indexOf("#")===-1)return v(d(t));var e=document.getElementById(t.replace("#",""));return v(e)}}(),function(){var t=["domenica","lunedì","martedì","mercoledì","giovedì","venerdì","sabato"],e=["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"];cjs.Date=cjs.create({constructor:function(t){this._date=t?new Date(t):new Date},getMonthName:function(){return cjs.Date.getMothName(this._date.getMonth())},getShortMonthName:function(){return e[this._date.getMonth()].substr(0,3)},getDayName:function(){return cjs.Date.getDayName(this._date.getDay())},getShortDayName:function(){return t[this._date.getDay()].substr(0,3)},format:function(t){return t=t.replace(/dddd/g,this.getDayName()),t=t.replace(/Dddd/g,this.getDayName().capitalize()),t=t.replace(/ddd/g,this.getShortDayName()),t=t.replace(/Ddd/g,this.getShortDayName().capitalize()),t=t.replace(/dd/g,this._date.getDate().toString().padLeft(2,0)),t=t.replace(/mmmm/g,this.getMonthName()),t=t.replace(/Mmmm/g,this.getMonthName().capitalize()),t=t.replace(/mmm/g,this.getShortMonthName()),t=t.replace(/Mmm/g,this.getShortMonthName().capitalize()),t=t.replace(/mm/g,(this._date.getMonth()+1).toString().padLeft(2,0)),t=t.replace(/yyyy/g,this._date.getFullYear().toString()),t=t.replace(/yy/g,this._date.getFullYear().toString().substr(2,2)),t=t.replace(/TT/g,this._date.getHours().toString().padLeft(2,0)),t=t.replace(/tt/g,this._date.getMinutes().toString().padLeft(2,0))}}),cjs.Date.getDayName=function(e){return t[e]},cjs.Date.getMothName=function(t){return e[t]}}(),cjs.Need=function(){var t={WAIT:0,DONE:1,FAIL:2},e=function(t,e,n){t.returnData[e]=n,t.status=e,t.collection.filter(function(t){return t.status===e}).forEach(function(e){e.action(n,t.id)})},n=function(t,e,n){t.status===e?n(t.returnData[e],t.id):t.collection.push({action:n,status:e})},r=function(){var r={},i={returnData:[],status:t.WAIT,id:-1,collection:[]};return r.resolve=function(n){i.status===t.WAIT&&e(i,t.DONE,n)},r.fail=function(n){return e(i,t.FAIL,n),r},r.then=function(e){return n(i,t.DONE,e),r},r.onFail=function(e){n(i,t.FAIL,e)},r.status=function(){return i.status},r.setId=function(t){i.id=t},r},i=function(e){var n=e.errors;return e.status===t.DONE&&(n=e.args.slice(0)),n},o=function(e,n,r){r.status===e?n.apply(null,i(r)):e===t.DONE?r.done.push(n):r.fail=n},a=function(e){var n={},r={done:[],fail:function(){},args:[],errors:[],count:0,counter:0,status:t.WAIT,collection:[]};return n.add=function(t){return t.setId(r.counter++),r.collection.push(t),t.then(function(t,e){n.itemOnDone(t,e)}),t.onFail(function(t){n.itemOnFail(t)}),this},n.itemOnDone=function(e,n){r.count+=1,r.args[n]=e,r.count===r.collection.length&&(r.status=t.DONE,r.done.forEach(function(t){t.apply(this,i(r))}))},n.itemOnFail=function(e){r.errors.push(e),r.status=t.FAIL,r.fail.apply(this,i(r))},n.then=function(e){o(t.DONE,e,r)},n.onFail=function(e){o(t.FAIL,e,r)},n.get=function(t){return r.collection[t]},n.status=function(){return r.status},e.forEach(function(t){n.add(t)}),n},c=function(t){var e={},n=-1,r=function(){t.length=0,n=-1},i=function(o){n+=1,t.length>n?t[n](e,o).then(i).onFail(r):r()};return e.start=function(t){i(t)},e.push=function(e){t.push(e)},e.isRunning=function(){return n!==-1},e};return function(t){if(void 0===t)return r();if(Array.isArray(t)){if("object"==typeof t[0]||void 0===t[0])return a(t);if("function"==typeof t[0])return c(t)}}}(),cjs.bus=function(){var t=[],e={};return e.on=function(e,n,r){t.push({eventName:e,callback:n,priority:r||1e3})},e.off=function(e,n){var r=t.filter(function(t){return t.eventName===e&&t.callback===n})[0];t.splice(t.indexOf(r),1)},e.once=function(n,r,i){t.push({eventName:n,callback:function(){r(),e.off(n,r)},priority:i||1e3})},e.fire=function(e,n){t.filter(function(t){return t.eventName===e}).sort(function(t,e){return t.priority-e.priority}).forEach(function(t){t.callback(n)})},e.clear=function(){t.length=0},e}(),cjs.navigator={},function(obj){var packages=cjs.Collection(),imports=function(t){return packages.get(t)||createPackage(t)},getPackage=function(t){return packages.get(t).pack},importer={js:function(o,imported,pack){eval("imported = "+o.response.response);var needs=cjs.Need([]),total=0,importer=function(t){total++,needs.add(imports(t))};imported(importer),0===total?(pack.pack=imported(),pack.resolve(pack.pack)):needs.then(function(){pack.pack=imported(getPackage),pack.resolve(pack.pack)})},json:function(t,e,n){n.pack=t.toJSON(),n.resolve(t.toJSON())},text:function(t,e,n){n.pack=t.getResponseText(),n.resolve(t.getResponseText())}},createPackage=function(t){var e,n=cjs.Need();return packages.add(n,t),obj.get(t).then(function(r){var i=t.substr(t.lastIndexOf(".")+1);i="js"===i||"json"===i?i:"text",importer[i](r,e,n)}),n};obj.send=function(t,e,n){n=n||{};var r=cjs.Need(),i=getHttpObject();return i.open(t,e,1),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.overrideMimeType&&i.overrideMimeType(n.overrideMimeType),i.onreadystatechange=function(){200===i.status&&4===i.readyState?r.resolve(Response(i)):200!==i.status&&4===i.readyState&&r.fail(i)},i.send(),r},obj.get=function(t,e){return obj.send("GET",t,e||{})},obj.post=function(t,e){return obj.send("POST",t,e||{})},obj.put=function(t,e){return obj.send("PUT",t,e||{})},obj["delete"]=function(t,e){return obj.send("DELETE",t,e||{})},obj["import"]=function(t){return imports(t)};var Response=function(){var t={toJSON:function(){return JSON.parse(this.response.responseText)},getResponseText:function(){return this.response.responseText}};return function(e){return cjs.Object.extend({response:e},t)}}(),getHttpObject=function(){return window.ActiveXObject?new ActiveXObject("MSXML2.XMLHTTP.3.0"):new XMLHttpRequest},getScreenOrientation=function(){return window.innerWidth>window.innerHeight?"landscape":"portrait"},getBrowserInfo=function(t){if(t.match(/(OPR)[^\d]\d*.\d*/))return["","opera",t.match(/OPR[^\d](\d*.\d*)/)[1]];if(t.match(/(Chrome)\/(\d*\.\d*)/))return t.match(/(Chrome)\/(\d*\.\d*)/);if(t.match(/(Firefox)\/(\d*\.\d*)/))return t.match(/(Firefox)\/(\d*\.\d*)/);if(t.match(/(Safari)\/(\d*\.\d*)/)){var e=t.match(/(Version)\/(\d*\.\d*)/);return e[1]="Safari",e}if(t.match(/Trident\/(\d)/)){var n=Number(t.match(/Trident\/(\d)/)[1])+4;return["","IE",n.toString()]}return["","",""]},getOsInfo=function(t){var e=["",""];return t.match(/WOW64/)?(e[0]="windows",t.match(/Windows NT 6/)&&(e[1]="7")):t.match(/Macintosh/)?(e[0]="Macintosh",e[1]=t.match(/Mac OS X (\d*[^\d]\d*)/)[1].replace("_",".")):t.match(/Linux/)&&(e=["Linux","UNKNOWN"]),e};obj.deviceManager=function(t){var e=t.userAgent,n={};n.deviceType="desktop";var r=getOsInfo(e);n.os=r[0],n.osVersion=r[1];var i=getBrowserInfo(e);return n.browserName=i[1].toLowerCase(),n.browserVersion=i[2],n.getScreenOrientation=getScreenOrientation,n}}(cjs.navigator),cjs.Component=function(){var t={},e=[],n=function(t,e,n){var r=t;n.split("/").forEach(function(t){r=r[t]}),e.setText(r)},r=[],i=0,o=function(){var t={},e=[];return t.add=function(t,n){e.push({item:t,attribute:n})},t.collect=function(){e.forEach(function(t){cjs.navigator.send("GET","/data/"+t.attribute).then(function(e){n(e.toJSON(),t.item,t.attribute)})})},t.save=function(e){var n=t.get(e);return cjs.navigator.send("POST","/data/"+n.attribute)},t.get=function(t){var n=e.filter(function(e){return e.item.get()===t.get()});return n?n[0]:null},t}(),a=function(t,e,n){var r=t.trim().split(":"),i=r[0].split(","),o=r[1];i.forEach(function(t){e.addListener(t,function(t){n[o].call(n,t)})})},c=function(t,e,n){n.items.add(e,t)},s=function(t,e,n){o.add(e,t)},u=function(t,e,n){var r=t.getAttribute(n);r&&("data-on"===n&&a(r,t,e),"data-item"===n&&c(r,t,e),"data-bind"===n&&s(r,t,e))},f=function(t,e){if(t.getTagName()){var n=t.getTagName().match(/COREJS:(.*)/);if(n){var r=g.get(n[1].toCamelCase()),i=cjs.Object.extend(g({template:t.get().innerHTML?p(r.template,t.toJSON()):r.template,style:t.get().innerHTML?d(r.style,t.toJSON()):r.style,config:r.config}),r.controller);i.createIn(t.get(),"before");for(var o=0;o<t.attributes().length;o++){var a=t.attributes()[o];"class"!==a.name&&i.node.setAttribute(a.name,a.value)}return i.node.addStyle(t.get().className),e.items.add(i,t.getAttribute("data-id")),t.get().parentNode.removeChild(t.get()),i.node}}return null},h=function(t,e){t.children().forEach(function(t){h(t,e)}),t=f(t,e)||t,u(t,e,"data-on"),u(t,e,"data-item"),u(t,e,"data-bind")},l=function(t){function n(t,e,n,r){"insertRule"in t?t.insertRule(e+"{"+n+"}",r):"addRule"in t&&t.addRule(e,n,r)}t=t.replace(/\n/g,"");var r=e.filter(function(e){return e.style===t});if(r.length>0)var o=r[0].className;else{var o="CJS"+i++,a="."+o,c=function(){var t=document.createElement("style");return t.appendChild(document.createTextNode("")),document.head.appendChild(t),t.sheet}();t.split("}").forEach(function(t){var e=t.concat("}").match(/.*\{.*\}/);e&&e.forEach(function(t){var e,r=t.trim().match(/(.*)\{(.*)\}/);e=r[1].match(".&")?r[1].replace(/\.&/g,a):a+" "+r[1],r&&n(c,e,r[2],0)})}),e.push({className:o,style:t})}return o},d=function(e,n){var r=e.match(/\$\w*/g);return r&&r.forEach(function(t){t=t.replace("$",""),e=e.replace(new RegExp("\\$"+t,"g"),n[t]||"")}),Object.keys(t).forEach(function(n){r=e.match(new RegExp(n+"\\((.*)\\)"))||[],r[1]&&(e=e.replace(r[0],t[n](r[1])))}),e},p=function(t,e){for(var n=t.match(/\{\{\w*\}\}/g);n;)n.forEach(function(n){n=n.replace("{{","").replace("}}",""),t=t.replace(new RegExp("\\{\\{"+n+"\\}\\}","g"),e[n]||"")}),n=t.match(/\{\{\w*\}\}/g);return t},g=function(t){var e=t.config||{},n=d(t.style||"",e),r=p(t.template||"",e),i=cjs.Node(r),a={items:cjs.Collection(),template:r,style:n,config:e,node:i};return a.createIn=function(t,e){e?("before"===e&&t.parentNode.insertBefore(i.get(),t),"after"===e&&t.parentNode.insertBefore(i.get(),t.nextSibling)):t.appendChild(i.get(0)),n&&i.addStyle(l(n)),i&&h(i,a),a.init&&a.init(),o.collect()},a.get=function(t){return a.items.get(t)},a.save=function(){var t=[];return function e(n){o.get(n)&&t.push(o.save(n)),n.children().forEach(e)}(i),cjs.Need(t)},a};return g.register=function(t){t.controller=t.controller||{},r.push(t)},g.get=function(t){return r.filter(function(e){return e.name===t})[0]},g.registerStyleFunction=function(e,n){t[e]=n},g}();